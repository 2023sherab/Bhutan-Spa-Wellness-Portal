<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bhutan Spa & Wellness-Book a Therapist</title>

    <link rel="stylesheet" href="./style.css">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Belleza&display=swap" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Basic&family=Belleza&display=swap" rel="stylesheet">

        <!-- favicon -->
        <link rel="icon" type="image/x-icon" href="./assets/images/Spa-Logo.png">

</head>


<body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <!-- <script src="./script.js" charset="UTF-8"></script> -->
    <script src="//code.jquery.com/jquery.min.js"></script>

	<script type="text/javascript" >
		//<!-- start navigation -->
		$.get("navbar.html", function(data){
			$("#navigation").replaceWith(data);
		});

		// <!-- start footer -->
		$.get("footer.html", function(data){
			$("#footer").replaceWith(data);
		});		
	</script>

    <div id="navigation"></div>
    
    <!-- SPA THERAPIST FORM -->
    <section id="spaTherapistForm">
        <div>
            <main>
                <div class="py-5 text-center">
                    <h1>BOOK A THERAPIST</h1>
                </div>
    
                <div class="row g-5">
                    <div class="col-md-7 form col-lg-8">
                        <div class="text-left">
                            <p class="mb-4">To be eligible for appointment booking, users must be at least eighteen (18) years of age, however, spa treatments are only available to those three (3) years of age or older.</p>
                        </div>
                        <p class="mb-4">Spa therapist can take up to 1 number of guests at a time.</p>
                        <form id="bookingForm" class="needs-validation" novalidate="">
                            <div class="row g-3">
                                <div class="blankForm col-sm-12">
                                    <div class="col-sm-6 px-2">
                                        <label for="firstName" class="form-label">Your full name:</label>
                                        <input type="text" class="form-control" id="firstName" placeholder="Please enter your name" value="" required="">
                                        <div class="invalid-feedback">
                                            Valid first name is required.
                                        </div>
                                    </div>
                                    <div class="col-sm-6 px-2">
                                        <label for="ageRange" class="form-label">Age range of the one who is availing the service</label>
                                        <select class="form-select" id="ageRange" required="">
                                            <option value="">Select your age range</option>
                                            <option value="6 months-1 year">6 months-1 year</option>
                                            <option value="2 years-5 years">2 years-5 years</option>
                                            <option value="6 years-13 years">6 years-13 years</option>
                                            <option value="14 years-18 years">14 years-18 years</option>
                                            <option value="19 years-30 years">19 years-30 years</option>
                                            <option value="31 years-45 years">31 years-45 years</option>
                                            <option value="Above 46">Above 46</option>
                                        </select>
                                        <div class="invalid-feedback">
                                            Please select a valid age range.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <h5 class="mb-0 mt-4 px-4">Appointment Date & Time:</h5>
                            <div class="dateTime px-2 mb-4">
                                <div class="date col-sm-6 px-2">
                                    <label for="date" class="form-label">Date</label>
                                    <input type="date" id="date" class="form-control" required>
                                    <div class="invalid-feedback">
                                        Please select a valid date.
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="time px-2">
                                        <label for="time" class="form-label mt-1">Time</label>
                                        <select class="form-select" id="time" required>
                                            <option value="">Please select your preferred time</option>
                                            <option value="Morning">Morning</option>
                                            <option value="Afternoon">Afternoon</option>
                                            <option value="Evening">Evening</option>
                                            <option value="Night">Night</option>
                                        </select>
                                        <div class="invalid-feedback">
                                            Please select a valid time.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="blankForm col-sm-12">                             

                                <div class="col-sm-6 px-2">
                                    <label for="treatment" class="form-label">Choose your treatment</label>                               
                                    <select class="form-select" id="treatment" required="">
                                        <option value="">Select your treatment</option>
                                       <option value="Thai massage">Thai massage:   Nu.700</option>
                                        <option value="Swedish massage">Swedish massage:    Nu.750</option>
                                        <option value="Head massage">Head massage:  Nu.200</option>
                                        <option value="Shoulder massage">Shoulder massage:   Nu.450</option>
                                        <option value="Foot massage">Foot massage:  Nu.450</option>
                                        <option value="Baby massage">Baby massage:  Nu.400</option>
                                    </select>
                                    <div class="invalid-feedback">
                                        Please select a valid treatment.
                                    </div>
                                </div>
                                
                                <div class="col-sm-6 px-2">
                                    <label for="country" class="form-label">Choose your preferred spa therapist</label>
                                    <select class="form-select" id="country" required="">
                                        <option value="">Select your preferred therapist</option>                                       
                                    </select>
                                    <div class="invalid-feedback">
                                        Please select a valid therapist.
                                    </div>
                                </div>                               
                            </div>


                            <hr class="hr my-5">
                            <h5 class="mt-5">POLICY</h5>
                            <p class="mb-3">To secure your booking, a 50% advance payment is required. You will then be redirected to a secure WhatsApp Business link for payment through various mobile banking applications. If you cancel the appointment after confirmation, 50% of the deposit will be retained as a cancellation fee.</p>
                            <div class="form-check my-4">
                                <input id="ageConfirmation" name="ageConfirmation" type="checkbox" class="form-check-input" required>
                                <label class="form-check-label px-3" for="ageConfirmation">I agree that I am 18 years of age or older.</label>
                            </div>
    
                            <button type="button" class="btn" id="submitButton">SUBMIT THE FORM & PROCEED WITH THE ADVANCEMENT PAYMENT</button>
    
                        </form>
                    </div>
                </div>
            </main>
        </div>
    </section>
    
<!-- END-BOOK-THERAPIST -->
<div id="footer"></div>    

<script>
    // Function to validate form fields
    function validateForm() {
        var isValid = true;
        var form = document.getElementById("bookingForm");

        // Check if all required fields are filled
        Array.from(form.elements).forEach(function(element) {
            if (element.required && element.value.trim() === "") {
                element.classList.add("is-invalid");
                var errorElement = document.getElementById(element.id + "Error");
                if (errorElement) {
                    errorElement.style.display = "inline";
                }
                isValid = false;
            }
        });

        // Check if age confirmation checkbox is checked
        var ageConfirmation = document.getElementById("ageConfirmation");
        if (!ageConfirmation.checked) {
            ageConfirmation.classList.add("is-invalid");
            var ageErrorElement = document.getElementById("ageError");
            if (ageErrorElement) {
                ageErrorElement.style.display = "inline";
            }
            isValid = false;
        }

        if (!isValid) {
            alert("Please fill all the required fields and confirm your age.");
        }

        return isValid;
    }

    // Function to generate WhatsApp message with filled form data in list format
    function generateWhatsAppMessage() {
        var form = document.getElementById("bookingForm");
        var formData = new FormData(form);
        var message = "Hello " + formData.get("country") + ", I would like to book an appointment. Here are the details:\n\n";

        formData.forEach(function(value, key) {
            if (key !== "ageConfirmation") { // Skip the age confirmation checkbox
                message += key.charAt(0).toUpperCase() + key.slice(1) + ": " + value + "\n";
            }
        });

        // Add age confirmation
        var ageConfirmation = document.getElementById("ageConfirmation").checked;
        message += "Age Confirmation: " + (ageConfirmation ? "Yes" : "No") + "\n";

        return message;
    }

    // Function to submit the form
    function submitForm() {
        if (validateForm()) {
            var therapist = document.getElementById("country").value.trim(); // Trim whitespace
            var message = generateWhatsAppMessage();

            // Assuming each therapist's WhatsApp number is stored in an object
            var therapistWhatsAppNumbers = {
                "Changa Lhamo": "97517919089",
                "Dawa Choden": "97517953183",
                "Dochen": "97517454107",
                "Dorji Wangda": "97517858542",
                "Kinley Pem": "97577290825",
                "Kinley Wangmo": "97517580753",
                "Kuenga Yuden": "97517708053",
                "Leki Wangmo": "97517943608",
                "Nima Lhadon": "97517901743",
                "Pema Tshering": "97517423065",
                "Tashi Dorji": "97577301268",
                "Thinley Wangmo": "97577861930",
                "Tshomo Tshomo": "97517624883",
                "Tshering Lham": "97517859177",
                "Wangchuk Dema": "97517941831",
                "Yangka Dem": "97517265521",
                "Yoenten": "97517265521",
                "Yeshi Choden": "97517452149",
                "Yeshi Dema": "97517684320",
                "You Raj Suberi": "97517419575"
            };

            // Check if the selected therapist has a WhatsApp number
            if (therapistWhatsAppNumbers.hasOwnProperty(therapist)) {
                var therapistWhatsAppNumber = therapistWhatsAppNumbers[therapist];
                // Open WhatsApp link with prefilled message
                var url = "https://wa.me/" + therapistWhatsAppNumber + "?text=" + encodeURIComponent(message);

                // Check if it's being opened on a desktop or a web browser
                if (navigator.platform.toUpperCase().indexOf('MAC') >= 0 || navigator.platform.toUpperCase().indexOf('WIN') >= 0) {
                    // Open WhatsApp desktop app
                    window.location.href = url;
                } else {
                    // Open WhatsApp web
                    window.open(url, "_blank");
                }
            } else {
                alert("Selected therapist does not have a WhatsApp number.");
            }
        }
    }

    // Event listener for form submission
    document.getElementById("submitButton").addEventListener("click", function(event) {
        event.preventDefault();
        submitForm();
    });

    // Event listener for form inputs change
    document.getElementById("bookingForm").addEventListener("change", function() {
        // Remove 'is-invalid' class and hide error messages when user starts typing
        this.querySelectorAll(".is-invalid").forEach(function(element) {
            element.classList.remove("is-invalid");
            var errorElement = document.getElementById(element.id + "Error");
            if (errorElement) {
                errorElement.style.display = "none";
            }
        });
    });

    // Sorting based on specialty
    document.addEventListener('DOMContentLoaded', () => {
        var servicesDropdown = document.getElementById('treatment');
        var therapistDropdown = document.getElementById('country');

        var therapists = [
            { name: 'Changa Lhamo', specialty: 'Swedish massage' },
            { name: 'Dawa Choden', specialty: 'Shoulder massage' },
            { name: 'Dochen', specialty: 'Thai massage' },
            { name: 'Dorji Wangda', specialty: 'Swedish massage' },
            { name: 'Kinley Pem', specialty: 'Head massage' },
            { name: 'Kinley Wangmo', specialty: 'Head massage' },
            { name: 'Kuenga Yuden', specialty: 'Head massage' },
            { name: 'Leki Wangmo', specialty: 'Baby massage' },
            { name: 'Nima Lhadon', specialty: 'Swedish massage' },
            { name: 'Pema Tshering', specialty: 'Foot massage' },
            { name: 'Tashi Dorji', specialty: 'Foot massage' },
            { name: 'Thinley Wangmo', specialty: 'Swedish massage' },
            { name: 'Tshomo Tshomo', specialty: 'Thai massage' },
            { name: 'Tshering Lham', specialty: 'Head massage' },
            { name: 'Wangchuk Dema', specialty: 'Baby massage' },
            { name: 'Yangka Dem', specialty: 'Thai massage' },
            { name: 'Yoenten', specialty: 'Foot massage' },
            { name: 'Yeshi Choden', specialty: 'Shoulder massage' },
            { name: 'Yeshi Dema', specialty: 'Foot massage' },
            { name: 'You Raj Suberi', specialty: 'Shoulder massage' }
        ];

        servicesDropdown.addEventListener('change', () => {
            var selectedService = servicesDropdown.value;
            therapistDropdown.innerHTML = '<option value="" class="therapists">--Therapist available based on the selected treatment--</option>';

            var filteredTherapists = therapists.filter(therapist => therapist.specialty === selectedService);

            filteredTherapists.forEach(therapist => {
                var option = document.createElement('option');
                option.value = therapist.name;
                option.textContent = therapist.name;
                therapistDropdown.appendChild(option);
            });
        });
    });

    // Add the following HTML elements to your HTML file
    // <div id="formDataContainer" style="display: none;">
    //     <h3>Filled Form Data:</h3>
    //     <ul id="formDataList"></ul>
    // </div>
</script>

</body>
</html>
